# wireguard + traefik + authelia
Docker Compose stack to deploy wireguard VPN server with [wg-easy](https://github.com/wg-easy/wg-easy), [traefik](https://github.com/traefik/traefik) as reverse proxy to access wg-easy UI and [authelia](https://github.com/authelia/authelia) for authentication.

## Deploy
- `docker` and `docker-compose` should be installed
- Generate password hash for users in Authelia
    ```bash
    docker run --rm authelia/authelia:latest \
    authelia crypto hash generate argon2 \
    --password 'my-password'
    ```

- Update authelia users configuration in [./config/users_database.yml](./config/users_database.yml)
    ```bash
    users:
    your-user-name:
        disabled: true
        displayname: "User Name"
        password: "<generates-passowrd-hash>"
        email: "root@localhost"
    ```
- Get duckdns token and export below environmental varaibles
    ```bash
    $ export MY_PROVIDER="duckdns"
    $ export MY_DOMAIN=""
    $ export DUCKDNS_TOKEN=""

    $ docker-compose up -d
    ```
- Once stack is up and running. Go to your `${MY_DOMAIN}` and log in with your passoword and click register like below
   
   <img src="https://i.ibb.co/P4SMnb9/Screenshot-2024-07-21-at-17-00-46.png" alt="drawing" width="200"/>
- Get 2fa first code in `config/notification.txt`
    NOTE: This `config/notification.txt` is automatically created by authelia. 
    For example below
    ```bash
    cat config/notification.txt
    Date: 2024-07-21 14:55:11.30894104 +0000 UTC m=+43.154509640
    Recipient: {Test User authelia@authelia.com}
    Subject: Confirm your identity
    Hi Test User,

    This email has been sent to you in order to validate your identity. Purpose: Confirm your identity.

    If you did not initiate the process your credentials might have been compromised and you should:
        1. Visit the revocation link
        2. Reset your password or other login credentials
        3. Contact an Administrator

    To confirm your identity please use the following single-use code: TXQAT55T

    This email was generated by a user with the IP XXXXXX.

    The following link can be utilized to revoke the code (this is a logged event): XXXX
    ```